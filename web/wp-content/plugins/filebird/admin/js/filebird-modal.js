var FileBird_Popup={init:function(){if(jQuery("#filebird_sidebar").length)var e=setInterval(()=>{if(jQuery("div[id^='__wp-uploader-id-'].supports-drag-drop:visible").find("div#filebird_sidebar").length)clearInterval(e);else{var r=jQuery("div[id^='__wp-uploader-id-'].supports-drag-drop:visible").attr("id");if(r){jQuery("#filebird_sidebar").appendTo("#"+r+" .media-menu");var t=localStorage.getItem("current_folder")||"all";jQuery("#menu-item-"+t+" .jstree-anchor").trigger("click"),jQuery("#filebird_sidebar").show(),jQuery(".fb-treeview-loading").hide()}}},300);else jQuery.ajax({url:ajaxurl,type:"post",dataType:"text",data:{action:"filebird_ajax_treeview_folder",nonce:window.njt_fb_nonce},success:function(e){var r=setInterval(()=>{if(jQuery("div[id^='__wp-uploader-id-'].supports-drag-drop:visible").find("div#filebird_sidebar").length)clearInterval(r);else{var t=jQuery("div[id^='__wp-uploader-id-'].supports-drag-drop:visible").attr("id");if(t){var i="#"+t+" .media-menu";jQuery(e).appendTo(i),jQuery(".fb-treeview-loading").hide(),DhTreeFolder.init(),ntWMC.dropFile();var l=localStorage.getItem("current_folder")||"all";jQuery("#menu-item-"+l+" .jstree-anchor").trigger("click"),jQuery("#filebird_sidebar").show(),setTimeout(()=>{jQuery("#filebird_sidebar").bind("remove",function(){FileBird_Popup.init()})},100),FileBird_Popup.jstree.init();var n=jQuery(i+" .media-menu-item:not(.fb-treeview-loading)").length;jQuery("#njt-filebird-folderTree").mCustomScrollbar({autoHideScrollbar:!0,setHeight:jQuery(i).height()-34*n-240}),FileBird_Popup.toolbar.init(),FileBird_Popup.tooltip.init()}}},300)}})},jstree:{init:function(){FileBird_Popup.jstree.default(),"all"!==localStorage.getItem("current_folder")&&"undefined"!==localStorage.getItem("current_folder")&&null!=localStorage.getItem("current_folder")||jQuery("#menu-item-all .menu-item-bar").trigger("click")},default:function(){jQuery("#njt-filebird-defaultTree").length&&(jQuery("#njt-filebird-defaultTree").jstree({core:{themes:{responsive:!1,icons:!1}}}),jQuery("#njt-filebird-defaultTree").on("changed.jstree",function(e,r){if(r.node){var t=r.node.li_attr["data-id"];if(localStorage.setItem("current_folder",t),jQuery(".jstree-anchor.jstree-clicked").removeClass("jstree-clicked"),jQuery(".jstree-node.current-dir").removeClass("current-dir"),jQuery(".jstree-node[data-id='"+t+"']").addClass("current-dir"),jQuery(".jstree-node[data-id='"+t+"']").children(".jstree-anchor").addClass("jstree-clicked"),jQuery(".jstree-anchor.need-refresh").length){var i=jQuery(".filebird_sidebar"),l=ntWMC.ntWMCgetBackboneOfMedia(i);if(l.browser.length>0&&"object"==typeof l.view)try{l.view.collection.props.set({ignore:+new Date})}catch(e){console.log(e)}else window.location.reload();jQuery(".jstree-anchor.need-refresh").removeClass("need-refresh")}jQuery(".wpmediacategory-filter").val(t),jQuery(".wpmediacategory-filter").trigger("change")}jQuery(".menu-item.current_folder").length&&(jQuery('select[name="njt_filebird_folder"]').length||jQuery(".menu-item.current_folder").removeClass("current_folder"))}))}},sweetAlert:{delete:function(e){var r=0;r=Array.isArray(e)?e[0].data("id"):e.data("id");var t=jQuery("menu-item-"+r);jQuery(t).next().find(".menu-item-data-parent-id").length&&jQuery(t).next().find(".menu-item-data-parent-id").val()==r?swal({title:filebird_translate.oops,text:filebird_translate.folder_are_sub_directories,type:"error"}):swal({title:filebird_translate.are_you_sure,text:filebird_translate.not_able_recover_folder,type:"warning",confirmButtonText:filebird_translate.yes_delete_it,showCancelButton:!0,cancelButtonText:filebird_translate.cancel}).then(function(e){e.value&&(njt_trigger_folder.delete(r),swal(filebird_translate.deleted+"!",filebird_translate.folder_deleted,"success"))})}},toolbar:{init:function(){FileBird_Popup.toolbar.create(),FileBird_Popup.toolbar.delete()},create:function(){jQuery(".js__nt_create").length&&jQuery(".js__nt_create").on("click",function(){var e,r=jQuery("#njt-filebird-folderTree").jstree(!0),t=jQuery(this).data("type");(e=r.create_node(null,{type:t}))&&r.edit(e)})},delete:function(){jQuery(".js__nt_delete").length&&jQuery(".js__nt_delete").on("click",function(){var e=jQuery("#njt-filebird-folderTree .current_folder");if(!e.length)return!1;FileBird_Popup.sweetAlert.delete(e)})}},tooltip:{init:function(){jQuery(".menu-item-bar").bind({mouseenter:function(){var e=jQuery(this),r=e.find(".item-title").innerWidth(),t=e.find(".menu-item-title").innerWidth(),i=e.find(".menu-item-title").text();r<t+10&&tippy(e[0],{content:i,sticky:!0,offset:"0, 0",arrow:!0,zIndex:99999999,maxWidth:200})}})}}};