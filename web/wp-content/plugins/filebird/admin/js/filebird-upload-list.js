!function(t){"use strict";t(document).ready(function(){wp.media.view.Attachment.Library;var e=filebird_translate.move_1_file;t("body").append('<div id="njt-filebird-attachment" data-id="">'+e+"</div>");var i=t("#njt-filebird-attachment");t.each(filebird_taxonomies.folder.term_list,function(e,i){t(".wpmediacategory-filter").append('<option value="'+i.term_id+'">'+i.term_name+"</option>")}),t(".wpmediacategory-filter").val(njt_filebird_dh.current_folder),t.each(t("table.wp-list-table tr"),function(n,a){t(a).draggable({cursorAt:{top:0,left:0},helper:function(e){return t("<span></span>")},start:function(n,a){var d=t('.wp-list-table input[name="media[]"]:checked');d.length>0&&(e=filebird_translate.Move+" "+d.length+" "+filebird_translate.files),i.html(e),i.show(),t("body").addClass("njt-draging")},stop:function(e,n){i.hide(),t("body").removeClass("njt-draging")},drag:function(e,n){var a=t(this).attr("id");a=a.match(/post-([\d]+)/),i.data("id",a[1]),i.css({top:e.clientY-15,left:e.clientX-15})}})}),t("#wpcontent .jstree-anchor").droppable({drop:function(e,n){var a=t(this).parent().attr("data-id"),d=function(){var e=t('.wp-list-table input[name="media[]"]:checked'),i=[];if(e.length)return e.each(function(e,n){i.push(t(n).val())}),i;return!1}();d.length?function(e,i,n){t(n.target).addClass("need-refresh");var a={};a.ids=e,a.folder_id=i,a.action="filebird_save_multi_attachments",a.nonce=window.njt_fb_nonce,ntWMC.filebird_begin_loading(),t.each(a.ids,function(e,i){t("#post-"+i).addClass("njt-opacity")}),jQuery.ajax({type:"POST",dataType:"json",data:a,url:ajaxurl,success:function(e){if(e.success&&(e.data.forEach(function(t){ntWMC.updateCount(t.from,t.to)}),t(".jstree-anchor").addClass("need-refresh"),null!=t(".wpmediacategory-filter").val())){t.each(a.ids,function(e,i){t("#post-"+i).remove()});var i=t(".wp-list-table tbody tr").length;0==i?(t(".wp-list-table tbody").append(njt_filebird_dh.no_item_html),t(".displaying-num").hide()):t(".displaying-num").text(i+" "+(1==i?njt_filebird_dh.item:njt_filebird_dh.items))}t(".wp-list-table tbody tr").removeClass("njt-opacity"),ntWMC.filebird_finish_loading()}})}(d,a,e):function(e,n){var a=i.data("id"),d=t('.attachment[data-id="'+a+'"]'),r=t(".wpmediacategory-filter").val();if("all"===n||n==r)return void t(".wp-list-table tbody tr").removeClass("njt-opacity");ntWMC.filebird_begin_loading(),t("#post-"+a).addClass("njt-opacity"),jQuery.ajax({type:"POST",dataType:"json",data:{id:a,action:"nt_wcm_get_terms_by_attachment",nonce:window.njt_fb_nonce},url:ajaxurl,success:function(i){var l=Array.from(i.data,t=>t.term_id);if(l.includes(Number(n)))return ntWMC.filebird_finish_loading(),void t(".wp-list-table tbody tr").removeClass("njt-opacity");t(e.target).addClass("need-refresh");var o={};o.id=a,o.attachments={},o.attachments[a]={menu_order:0},o.folder_id=n,o.action="filebird_save_attachment",o.nonce=window.njt_fb_nonce,jQuery.ajax({type:"POST",dataType:"json",data:o,url:ajaxurl,success:function(e){if(e.success&&(t.each(l,function(t,e){ntWMC.updateCount(e,n)}),console.log(r,l.length),"all"!==r||l.length||ntWMC.updateCount(-1,n),-1==r&&ntWMC.updateCount(-1,n),"all"!=r&&d.detach()),ntWMC.filebird_finish_loading(),t(".wp-list-table tbody tr").removeClass("njt-opacity"),null!=t(".wpmediacategory-filter").val()){t("#post-"+o.id).remove();var i=t(".wp-list-table tbody tr").length;0==i?(t(".wp-list-table tbody").append(njt_filebird_dh.no_item_html),t(".displaying-num").hide()):t(".displaying-num").text(i+" "+(1==i?njt_filebird_dh.item:njt_filebird_dh.items))}}})}})}(e,a)}}),t(".menu-item-bar").bind({mouseenter:function(){var e=t(this),i=e.find(".item-title").innerWidth(),n=e.find(".menu-item-title").innerWidth(),a=e.find(".menu-item-title").text();i<n+10&&tippy(e[0],{content:a,sticky:!0,offset:"0, 35",arrow:!0,zIndex:99999999,maxWidth:220})}})})}(jQuery);